<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Profit Risks for New Oil Wells | Connie M Dang Project Portfolio</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Profit Risks for New Oil Wells" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An oil company is looking for a profitable region for oil production. Help decide where to drill a new well by examining the different regions. Build a model that will help to select the region with the highest profitability by predicting the volume of reserves in new wells." />
<meta property="og:description" content="An oil company is looking for a profitable region for oil production. Help decide where to drill a new well by examining the different regions. Build a model that will help to select the region with the highest profitability by predicting the volume of reserves in new wells." />
<link rel="canonical" href="https://cmdang-mochi.github.io/ds-projects/machine%20learning/python/pandas/numpy/scikit-learn/tabulate/scipy/2020/11/22/profit_risks_for_new_oil_wells.html" />
<meta property="og:url" content="https://cmdang-mochi.github.io/ds-projects/machine%20learning/python/pandas/numpy/scikit-learn/tabulate/scipy/2020/11/22/profit_risks_for_new_oil_wells.html" />
<meta property="og:site_name" content="Connie M Dang Project Portfolio" />
<meta property="og:image" content="https://cmdang-mochi.github.io/ds-projects/images/oil_well.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-22T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"An oil company is looking for a profitable region for oil production. Help decide where to drill a new well by examining the different regions. Build a model that will help to select the region with the highest profitability by predicting the volume of reserves in new wells.","url":"https://cmdang-mochi.github.io/ds-projects/machine%20learning/python/pandas/numpy/scikit-learn/tabulate/scipy/2020/11/22/profit_risks_for_new_oil_wells.html","@type":"BlogPosting","headline":"Profit Risks for New Oil Wells","dateModified":"2020-11-22T00:00:00-06:00","datePublished":"2020-11-22T00:00:00-06:00","image":"https://cmdang-mochi.github.io/ds-projects/images/oil_well.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://cmdang-mochi.github.io/ds-projects/machine%20learning/python/pandas/numpy/scikit-learn/tabulate/scipy/2020/11/22/profit_risks_for_new_oil_wells.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/ds-projects/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://cmdang-mochi.github.io/ds-projects/feed.xml" title="Connie M Dang | Project Portfolio" /><link rel="shortcut icon" type="image/x-icon" href="/ds-projects/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/ds-projects/">Connie M Dang | Project Portfolio</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ds-projects/about/">About Me</a><a class="page-link" href="/ds-projects/search/">Search</a><a class="page-link" href="/ds-projects/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Profit Risks for New Oil Wells</h1><p class="page-description">An oil company is looking for a profitable region for oil production. Help decide where to drill a new well by examining the different regions. Build a model that will help to select the region with the highest profitability by predicting the volume of reserves in new wells.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-11-22T00:00:00-06:00" itemprop="datePublished">
        Nov 22, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      17 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/ds-projects/categories/#Machine Learning">Machine Learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/ds-projects/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/ds-projects/categories/#pandas">pandas</a>
        &nbsp;
      
        <a class="category-tags-link" href="/ds-projects/categories/#numpy">numpy</a>
        &nbsp;
      
        <a class="category-tags-link" href="/ds-projects/categories/#scikit-learn">scikit-learn</a>
        &nbsp;
      
        <a class="category-tags-link" href="/ds-projects/categories/#tabulate">tabulate</a>
        &nbsp;
      
        <a class="category-tags-link" href="/ds-projects/categories/#scipy">scipy</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/cmdang-mochi/ds-projects/tree/master/_notebooks/2020-11-22-profit_risks_for_new_oil_wells.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/ds-projects/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/cmdang-mochi/ds-projects/master?filepath=_notebooks%2F2020-11-22-profit_risks_for_new_oil_wells.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/ds-projects/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/cmdang-mochi/ds-projects/blob/master/_notebooks/2020-11-22-profit_risks_for_new_oil_wells.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/ds-projects/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Project-Description">Project Description </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Data-description">Data description </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Import-Libraries">Import Libraries </a></li>
<li class="toc-entry toc-h1"><a href="#Load-data">Load data </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Preprocessing-data">Preprocessing data </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Split-Data">Split Data </a></li>
<li class="toc-entry toc-h1"><a href="#Model-building">Model building </a>
<ul>
<li class="toc-entry toc-h2"><a href="#geo_0-region">geo_0 region </a></li>
<li class="toc-entry toc-h2"><a href="#geo_1-region">geo_1 region </a></li>
<li class="toc-entry toc-h2"><a href="#geo_2-region">geo_2 region </a></li>
<li class="toc-entry toc-h2"><a href="#Conclusion">Conclusion </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Profit-calculation">Profit calculation </a></li>
<li class="toc-entry toc-h1"><a href="#Profit-from-a-set-of-selected-oil-wells-and-model-predictions">Profit from a set of selected oil wells and model predictions </a></li>
<li class="toc-entry toc-h1"><a href="#Calculate-risks-and-profit-for-each-region">Calculate risks and profit for each region </a></li>
<li class="toc-entry toc-h1"><a href="#Overall-Conclusion">Overall Conclusion </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-22-profit_risks_for_new_oil_wells.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Project-Description">
<a class="anchor" href="#Project-Description" aria-hidden="true"><span class="octicon octicon-link"></span></a>Project Description<a class="anchor-link" href="#Project-Description"> </a>
</h1>
<hr>
<p>Analyze potential profit and risks for an oil company.</p>
<p>Create a model that will analyze different proposed locations for a new oil well that will maximize profits while minimizing risk.</p>
<p>Goal is to find the best place for a new oil well using provided data from three different regions.</p>
<p>Steps to choose the location:</p>
<ul>
<li>Collect the oil well parameters in the selected region: oil quality and volume of reserves;</li>
<li>Build a model for predicting the volume of reserves in the new wells;</li>
<li>Pick the oil wells with the highest estimated values;</li>
<li>Pick the region with the highest total profit for the selected oil wells.</li>
</ul>
<p>There is data on oil samples from three regions. Parameters of each oil well in the region are already known. Build a model that will help to pick the region with the highest profit margin. Analyze potential profit and risks using the Bootstrapping technique.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-description">
<a class="anchor" href="#Data-description" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data description<a class="anchor-link" href="#Data-description"> </a>
</h2>
<hr>
<p>Geological exploration data for the three regions are stored in files:</p>
<ul>
<li>
<code>id</code> â€” unique oil well identifier</li>
<li>
<code>f0</code>, <code>f1</code>, <code>f2</code> â€” three features of points (their specific meaning is unimportant, but the features themselves are significant)</li>
<li>
<code>product</code> â€” volume of reserves in the oil well (thousand barrels).</li>
</ul>
<p><strong>Conditions:</strong></p>
<ul>
<li>Only linear regression is suitable for model training (the rest are not sufficiently predictable).</li>
<li>When exploring the region, a study of 500 points is carried with picking the best 200 points for the profit calculation.</li>
<li>The budget for development of 200 oil wells is 100 USD million.</li>
<li>One barrel of raw materials brings 4.5 USD of revenue The revenue from one unit of product is 4,500 dollars (volume of reserves is in thousand barrels).</li>
<li>After the risk evaluation, keep only the regions with the risk of losses lower than 2.5%. From the ones that fit the criteria, the region with the highest average profit should be selected.</li>
</ul>
<p>The data is synthetic: contract details and well characteristics are not disclosed.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Import-Libraries">
<a class="anchor" href="#Import-Libraries" aria-hidden="true"><span class="octicon octicon-link"></span></a>Import Libraries<a class="anchor-link" href="#Import-Libraries"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">RandomState</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span> <span class="k">as</span> <span class="n">st</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Load-data">
<a class="anchor" href="#Load-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Load data<a class="anchor-link" href="#Load-data"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo_0</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'/content/datasets/geo_data_0.csv'</span><span class="p">)</span>
<span class="n">geo_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'/content/datasets/geo_data_1.csv'</span><span class="p">)</span>
<span class="n">geo_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'/content/datasets/geo_data_2.csv'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Functions to get descriptions and info from dataframe</span>

<span class="k">def</span> <span class="nf">get_information</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
  <span class="sd">""" Prints general info about the dataframe to get an idea of what it looks like"""</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Head: </span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
  <span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'*'</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span> <span class="c1"># Prints a break to seperate print data</span>
  
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Info: </span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
  <span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'*'</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

  <span class="nb">print</span><span class="p">(</span><span class="s1">'Describe: </span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
  <span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'*'</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

  <span class="nb">print</span><span class="p">(</span><span class="s1">'Columns with nulls: </span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
  <span class="n">display</span><span class="p">(</span><span class="n">get_null_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'*'</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

  <span class="nb">print</span><span class="p">(</span><span class="s1">'Shape: </span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
  <span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'*'</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

  <span class="nb">print</span><span class="p">(</span><span class="s1">'Duplicated: </span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of duplicated rows: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>

<span class="k">def</span> <span class="nf">get_null_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
  <span class="sd">"""Gets percentage of null values per column per dataframe"""</span>
  <span class="n">df_nulls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'missing_values'</span><span class="p">])</span>
  <span class="n">df_nulls</span><span class="p">[</span><span class="s1">'percent_of_nulls'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">df_nulls</span><span class="p">[</span><span class="s1">'missing_values'</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num</span><span class="p">)</span> <span class="o">*</span><span class="mi">100</span>
  <span class="k">return</span> <span class="n">df_nulls</span>

<span class="k">def</span> <span class="nf">get_null</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
  <span class="sd">"""Gets percentage of null values in dataframe"""</span>
  <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">percent</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

    <span class="n">num_of_nulls</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">num_of_nulls</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Columns </span><span class="si">{}</span><span class="s1"> has {:.</span><span class="si">{}</span><span class="s1">%} percent of Nulls, and </span><span class="si">{}</span><span class="s1"> number of nulls'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">percent</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">num_of_nulls</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">count</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of columns with NA: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">No NA columns found'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Opening dataset for geo_0</span>
<span class="n">get_information</span><span class="p">(</span><span class="n">geo_0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
</p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Head: 

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>txEyH</td>
      <td>0.705745</td>
      <td>-0.497823</td>
      <td>1.221170</td>
      <td>105.280062</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2acmU</td>
      <td>1.334711</td>
      <td>-0.340164</td>
      <td>4.365080</td>
      <td>73.037750</td>
    </tr>
    <tr>
      <th>2</th>
      <td>409Wp</td>
      <td>1.022732</td>
      <td>0.151990</td>
      <td>1.419926</td>
      <td>85.265647</td>
    </tr>
    <tr>
      <th>3</th>
      <td>iJLyR</td>
      <td>-0.032172</td>
      <td>0.139033</td>
      <td>2.978566</td>
      <td>168.620776</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Xdl7t</td>
      <td>1.988431</td>
      <td>0.155413</td>
      <td>4.751769</td>
      <td>154.036647</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Info: 

&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 100000 entries, 0 to 99999
Data columns (total 5 columns):
 #   Column   Non-Null Count   Dtype  
---  ------   --------------   -----  
 0   id       100000 non-null  object 
 1   f0       100000 non-null  float64
 2   f1       100000 non-null  float64
 3   f2       100000 non-null  float64
 4   product  100000 non-null  float64
dtypes: float64(4), object(1)
memory usage: 3.8+ MB
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>None</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Describe: 

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>100000.000000</td>
      <td>100000.000000</td>
      <td>100000.000000</td>
      <td>100000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.500419</td>
      <td>0.250143</td>
      <td>2.502647</td>
      <td>92.500000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.871832</td>
      <td>0.504433</td>
      <td>3.248248</td>
      <td>44.288691</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.408605</td>
      <td>-0.848218</td>
      <td>-12.088328</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.072580</td>
      <td>-0.200881</td>
      <td>0.287748</td>
      <td>56.497507</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.502360</td>
      <td>0.250252</td>
      <td>2.515969</td>
      <td>91.849972</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.073581</td>
      <td>0.700646</td>
      <td>4.715088</td>
      <td>128.564089</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.362331</td>
      <td>1.343769</td>
      <td>16.003790</td>
      <td>185.364347</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Columns with nulls: 

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>missing_values</th>
      <th>percent_of_nulls</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>f0</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>f1</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>f2</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>product</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Shape: 

</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>(100000, 5)</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Duplicated: 

Number of duplicated rows: 0
</pre>
</div>
</div>

</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dataset for <code>geo_0</code> show to have 100000 entries with no null/missing values and datatypes seem to be correct.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Opening dataset for geo_1</span>
<span class="n">get_information</span><span class="p">(</span><span class="n">geo_1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
</p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Head: 

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>kBEdx</td>
      <td>-15.001348</td>
      <td>-8.276000</td>
      <td>-0.005876</td>
      <td>3.179103</td>
    </tr>
    <tr>
      <th>1</th>
      <td>62mP7</td>
      <td>14.272088</td>
      <td>-3.475083</td>
      <td>0.999183</td>
      <td>26.953261</td>
    </tr>
    <tr>
      <th>2</th>
      <td>vyE1P</td>
      <td>6.263187</td>
      <td>-5.948386</td>
      <td>5.001160</td>
      <td>134.766305</td>
    </tr>
    <tr>
      <th>3</th>
      <td>KcrkZ</td>
      <td>-13.081196</td>
      <td>-11.506057</td>
      <td>4.999415</td>
      <td>137.945408</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AHL4O</td>
      <td>12.702195</td>
      <td>-8.147433</td>
      <td>5.004363</td>
      <td>134.766305</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Info: 

&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 100000 entries, 0 to 99999
Data columns (total 5 columns):
 #   Column   Non-Null Count   Dtype  
---  ------   --------------   -----  
 0   id       100000 non-null  object 
 1   f0       100000 non-null  float64
 2   f1       100000 non-null  float64
 3   f2       100000 non-null  float64
 4   product  100000 non-null  float64
dtypes: float64(4), object(1)
memory usage: 3.8+ MB
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>None</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Describe: 

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>100000.000000</td>
      <td>100000.000000</td>
      <td>100000.000000</td>
      <td>100000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.141296</td>
      <td>-4.796579</td>
      <td>2.494541</td>
      <td>68.825000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8.965932</td>
      <td>5.119872</td>
      <td>1.703572</td>
      <td>45.944423</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-31.609576</td>
      <td>-26.358598</td>
      <td>-0.018144</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-6.298551</td>
      <td>-8.267985</td>
      <td>1.000021</td>
      <td>26.953261</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.153055</td>
      <td>-4.813172</td>
      <td>2.011479</td>
      <td>57.085625</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>8.621015</td>
      <td>-1.332816</td>
      <td>3.999904</td>
      <td>107.813044</td>
    </tr>
    <tr>
      <th>max</th>
      <td>29.421755</td>
      <td>18.734063</td>
      <td>5.019721</td>
      <td>137.945408</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Columns with nulls: 

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>missing_values</th>
      <th>percent_of_nulls</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>f0</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>f1</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>f2</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>product</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Shape: 

</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>(100000, 5)</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Duplicated: 

Number of duplicated rows: 0
</pre>
</div>
</div>

</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dataset for <code>geo_1</code> show to have 100000 entries with no null/missing values and datatypes seem to be correct.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Opening dataset for geo_2</span>
<span class="n">get_information</span><span class="p">(</span><span class="n">geo_2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
</p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Head: 

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>fwXo0</td>
      <td>-1.146987</td>
      <td>0.963328</td>
      <td>-0.828965</td>
      <td>27.758673</td>
    </tr>
    <tr>
      <th>1</th>
      <td>WJtFt</td>
      <td>0.262778</td>
      <td>0.269839</td>
      <td>-2.530187</td>
      <td>56.069697</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ovLUW</td>
      <td>0.194587</td>
      <td>0.289035</td>
      <td>-5.586433</td>
      <td>62.871910</td>
    </tr>
    <tr>
      <th>3</th>
      <td>q6cA6</td>
      <td>2.236060</td>
      <td>-0.553760</td>
      <td>0.930038</td>
      <td>114.572842</td>
    </tr>
    <tr>
      <th>4</th>
      <td>WPMUX</td>
      <td>-0.515993</td>
      <td>1.716266</td>
      <td>5.899011</td>
      <td>149.600746</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Info: 

&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 100000 entries, 0 to 99999
Data columns (total 5 columns):
 #   Column   Non-Null Count   Dtype  
---  ------   --------------   -----  
 0   id       100000 non-null  object 
 1   f0       100000 non-null  float64
 2   f1       100000 non-null  float64
 3   f2       100000 non-null  float64
 4   product  100000 non-null  float64
dtypes: float64(4), object(1)
memory usage: 3.8+ MB
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>None</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Describe: 

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>100000.000000</td>
      <td>100000.000000</td>
      <td>100000.000000</td>
      <td>100000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.002023</td>
      <td>-0.002081</td>
      <td>2.495128</td>
      <td>95.000000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.732045</td>
      <td>1.730417</td>
      <td>3.473445</td>
      <td>44.749921</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-8.760004</td>
      <td>-7.084020</td>
      <td>-11.970335</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-1.162288</td>
      <td>-1.174820</td>
      <td>0.130359</td>
      <td>59.450441</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.009424</td>
      <td>-0.009482</td>
      <td>2.484236</td>
      <td>94.925613</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.158535</td>
      <td>1.163678</td>
      <td>4.858794</td>
      <td>130.595027</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.238262</td>
      <td>7.844801</td>
      <td>16.739402</td>
      <td>190.029838</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Columns with nulls: 

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>missing_values</th>
      <th>percent_of_nulls</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>f0</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>f1</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>f2</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>product</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Shape: 

</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>(100000, 5)</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>**************************************************************************************************** 

Duplicated: 

Number of duplicated rows: 0
</pre>
</div>
</div>

</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dataset for <code>geo_2</code> show to have 100000 entries with no null/missing values and datatypes seem to be correct.</p>
<p>From all the datasets, we might be able to drop the <strong>id</strong> column as it does not provide the models much information.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preprocessing-data">
<a class="anchor" href="#Preprocessing-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Preprocessing data<a class="anchor-link" href="#Preprocessing-data"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo_0_data</span> <span class="o">=</span> <span class="n">geo_0</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'id'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">geo_0_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">geo_1_data</span> <span class="o">=</span> <span class="n">geo_1</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'id'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">geo_1_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">geo_2_data</span> <span class="o">=</span> <span class="n">geo_2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'id'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">geo_2_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.705745</td>
      <td>-0.497823</td>
      <td>1.221170</td>
      <td>105.280062</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.334711</td>
      <td>-0.340164</td>
      <td>4.365080</td>
      <td>73.037750</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.022732</td>
      <td>0.151990</td>
      <td>1.419926</td>
      <td>85.265647</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.032172</td>
      <td>0.139033</td>
      <td>2.978566</td>
      <td>168.620776</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.988431</td>
      <td>0.155413</td>
      <td>4.751769</td>
      <td>154.036647</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-15.001348</td>
      <td>-8.276000</td>
      <td>-0.005876</td>
      <td>3.179103</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14.272088</td>
      <td>-3.475083</td>
      <td>0.999183</td>
      <td>26.953261</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6.263187</td>
      <td>-5.948386</td>
      <td>5.001160</td>
      <td>134.766305</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-13.081196</td>
      <td>-11.506057</td>
      <td>4.999415</td>
      <td>137.945408</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12.702195</td>
      <td>-8.147433</td>
      <td>5.004363</td>
      <td>134.766305</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.146987</td>
      <td>0.963328</td>
      <td>-0.828965</td>
      <td>27.758673</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.262778</td>
      <td>0.269839</td>
      <td>-2.530187</td>
      <td>56.069697</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.194587</td>
      <td>0.289035</td>
      <td>-5.586433</td>
      <td>62.871910</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.236060</td>
      <td>-0.553760</td>
      <td>0.930038</td>
      <td>114.572842</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.515993</td>
      <td>1.716266</td>
      <td>5.899011</td>
      <td>149.600746</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The datasets <code>geo_0</code>, <code>geo_1</code>, <code>geo_2</code> all have 100,000 entries with no missing values and have datatypes that seem to be correct. We were able to drop the <strong>id</strong> column as this would not provide much information for our model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Split-Data">
<a class="anchor" href="#Split-Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Split Data<a class="anchor-link" href="#Split-Data"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">RANDOM_STATE</span> <span class="o">=</span> <span class="mi">12345</span> <span class="c1">#Random_State</span>

<span class="k">def</span> <span class="nf">get_train_valid</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df_train</span><span class="p">,</span> <span class="n">df_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span> <span class="c1"># Splits data up to 75% train and 25% test</span>
    <span class="k">return</span> <span class="n">df_train</span><span class="p">,</span> <span class="n">df_valid</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo0_target</span> <span class="o">=</span> <span class="n">geo_0_data</span><span class="p">[</span><span class="s1">'product'</span><span class="p">]</span>
<span class="n">geo0_features</span> <span class="o">=</span> <span class="n">geo_0_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'product'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">geo0_x_train</span><span class="p">,</span> <span class="n">geo0_x_valid</span> <span class="o">=</span> <span class="n">get_train_valid</span><span class="p">(</span><span class="n">geo0_features</span><span class="p">)</span>
<span class="n">geo0_y_train</span><span class="p">,</span> <span class="n">geo0_y_valid</span> <span class="o">=</span> <span class="n">get_train_valid</span><span class="p">(</span><span class="n">geo0_target</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">geo0_x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">geo0_y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">geo0_x_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">geo0_y_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'geo_0 datasets: </span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Train:'</span><span class="p">,</span> <span class="n">geo0_x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">' Target Train:'</span><span class="p">,</span> <span class="n">geo0_y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Validation:'</span><span class="p">,</span> <span class="n">geo0_x_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">' Target Validation:'</span><span class="p">,</span> <span class="n">geo0_y_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>geo_0 datasets: 

Train: (75000, 3)  Target Train: (75000,)
Validation: (25000, 3)  Target Validation: (25000,)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo1_target</span> <span class="o">=</span> <span class="n">geo_1_data</span><span class="p">[</span><span class="s1">'product'</span><span class="p">]</span>
<span class="n">geo1_features</span> <span class="o">=</span> <span class="n">geo_1_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'product'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">geo1_x_train</span><span class="p">,</span> <span class="n">geo1_x_valid</span> <span class="o">=</span> <span class="n">get_train_valid</span><span class="p">(</span><span class="n">geo1_features</span><span class="p">)</span>
<span class="n">geo1_y_train</span><span class="p">,</span> <span class="n">geo1_y_valid</span> <span class="o">=</span> <span class="n">get_train_valid</span><span class="p">(</span><span class="n">geo1_target</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">geo1_x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">geo1_y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">geo1_x_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">geo1_y_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'geo_1 datasets: </span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Train:'</span><span class="p">,</span> <span class="n">geo1_x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">' Target Train:'</span><span class="p">,</span> <span class="n">geo1_y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Validation:'</span><span class="p">,</span> <span class="n">geo1_x_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">' Target Validation:'</span><span class="p">,</span> <span class="n">geo1_y_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>geo_1 datasets: 

Train: (75000, 3)  Target Train: (75000,)
Validation: (25000, 3)  Target Validation: (25000,)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo2_target</span> <span class="o">=</span> <span class="n">geo_2_data</span><span class="p">[</span><span class="s1">'product'</span><span class="p">]</span>
<span class="n">geo2_features</span> <span class="o">=</span> <span class="n">geo_2_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'product'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">geo2_x_train</span><span class="p">,</span> <span class="n">geo2_x_valid</span> <span class="o">=</span> <span class="n">get_train_valid</span><span class="p">(</span><span class="n">geo2_features</span><span class="p">)</span>
<span class="n">geo2_y_train</span><span class="p">,</span> <span class="n">geo2_y_valid</span> <span class="o">=</span> <span class="n">get_train_valid</span><span class="p">(</span><span class="n">geo2_target</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">geo2_x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">geo2_y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">geo2_x_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">geo2_y_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'geo_2 datasets: </span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Train:'</span><span class="p">,</span> <span class="n">geo2_x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">' Target Train:'</span><span class="p">,</span> <span class="n">geo2_y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Validation:'</span><span class="p">,</span> <span class="n">geo2_x_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">' Target Validation:'</span><span class="p">,</span> <span class="n">geo2_y_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>geo_2 datasets: 

Train: (75000, 3)  Target Train: (75000,)
Validation: (25000, 3)  Target Validation: (25000,)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-danger">
<b>Needs fixing:</b> We don't need valid part in the task because we don't tune parameters. Create only train(75%) and test(25%).
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Updated to only have validation(25%) and train(75%) datasets, since we do not need the test dataset for tunning parameters on our models</em></strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset for the three different regions were successfully split into train and validation datasets with a 75:25 ratio. There is no testing sub-dataset as the models will not be hyper-tuned.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Model-building">
<a class="anchor" href="#Model-building" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model building<a class="anchor-link" href="#Model-building"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">LinReg_sanity_check</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'---Model validation/prediction datasets scores---'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Accuracy:'</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'R2:'</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'RMSE:'</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="geo_0-region">
<a class="anchor" href="#geo_0-region" aria-hidden="true"><span class="octicon octicon-link"></span></a>geo_0 region<a class="anchor-link" href="#geo_0-region"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo0_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">geo0_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">geo0_x_train</span><span class="p">,</span> <span class="n">geo0_y_train</span><span class="p">)</span>
<span class="n">geo0_predictions</span> <span class="o">=</span> <span class="n">geo0_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">geo0_x_valid</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Sanity check for geo_0 model:'</span><span class="p">)</span>
<span class="n">LinReg_sanity_check</span><span class="p">(</span><span class="n">geo0_x_train</span><span class="p">,</span> <span class="n">geo0_x_valid</span><span class="p">,</span> <span class="n">geo0_y_train</span><span class="p">,</span> <span class="n">geo0_y_valid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Average volume of predicted reserves in geo_0 (thousand barrels):'</span><span class="p">,</span> <span class="n">geo0_predictions</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Sanity check for geo_0 model:
---Model validation/prediction datasets scores---
Accuracy: 0.27994321524487786
R2: 0.27994321524487786
RMSE: 37.5794217150813

Average volume of predicted reserves in geo_0 (thousand barrels): 92.59256778438038
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the data in geo_0, the accuracy, R2 and RMSE scores are pretty terrble. The accuracy and R2 score are very low and the RMSE score is very big.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="geo_1-region">
<a class="anchor" href="#geo_1-region" aria-hidden="true"><span class="octicon octicon-link"></span></a>geo_1 region<a class="anchor-link" href="#geo_1-region"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo1_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">geo1_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">geo1_x_train</span><span class="p">,</span> <span class="n">geo1_y_train</span><span class="p">)</span>
<span class="n">geo1_predictions</span> <span class="o">=</span> <span class="n">geo1_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">geo1_x_valid</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Sanity check for geo_1 model:</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="n">LinReg_sanity_check</span><span class="p">(</span><span class="n">geo1_x_train</span><span class="p">,</span> <span class="n">geo1_x_valid</span><span class="p">,</span> <span class="n">geo1_y_train</span><span class="p">,</span> <span class="n">geo1_y_valid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Average volume of predicted reserves in geo_1 (thousand barrels):'</span><span class="p">,</span> <span class="n">geo1_predictions</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Sanity check for geo_1 model:

---Model validation/prediction datasets scores---
Accuracy: 0.9996233978805126
R2: 0.9996233978805127
RMSE: 0.893099286775616

Average volume of predicted reserves in geo_1 (thousand barrels): 68.728546895446
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The scores for data in geo_1 are actually pretty good with accuracy and R2 score pretty close to 1 and RMSE score being very low.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="geo_2-region">
<a class="anchor" href="#geo_2-region" aria-hidden="true"><span class="octicon octicon-link"></span></a>geo_2 region<a class="anchor-link" href="#geo_2-region"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo2_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">geo2_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">geo2_x_train</span><span class="p">,</span> <span class="n">geo2_y_train</span><span class="p">)</span>
<span class="n">geo2_predictions</span> <span class="o">=</span> <span class="n">geo2_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">geo2_x_valid</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Sanity check for geo_2 model:</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="n">LinReg_sanity_check</span><span class="p">(</span><span class="n">geo2_x_train</span><span class="p">,</span> <span class="n">geo2_x_valid</span><span class="p">,</span> <span class="n">geo2_y_train</span><span class="p">,</span> <span class="n">geo2_y_valid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Average volume of predicted reserves in geo_2 (thousand barrels):'</span><span class="p">,</span> <span class="n">geo2_predictions</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Sanity check for geo_2 model:

---Model validation/prediction datasets scores---
Accuracy: 0.20524758386040443
R2: 0.20524758386040443
RMSE: 40.02970873393434

Average volume of predicted reserves in geo_2 (thousand barrels): 94.96504596800489
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similar to the model for geo_0, the scores here for geo_2 model are not that great with a very low accuracy and R2 score and high RMSE score.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">
<a class="anchor" href="#Conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion<a class="anchor-link" href="#Conclusion"> </a>
</h2>
<p>The table below shows each models' results using the valdiation datasets to make predictions:</p>
<hr>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">geo_0</th>
<th style="text-align:left">geo_1</th>
<th style="text-align:left">geo_2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Accuracy Score</td>
<td style="text-align:left">0.2799</td>
<td style="text-align:left">0.9996</td>
<td style="text-align:left">0.2052</td>
</tr>
<tr>
<td style="text-align:left">R2 Score</td>
<td style="text-align:left">0.2799</td>
<td style="text-align:left">0.9996</td>
<td style="text-align:left">0.2052</td>
</tr>
<tr>
<td style="text-align:left">RMSE Score</td>
<td style="text-align:left">37.579</td>
<td style="text-align:left">0.8903</td>
<td style="text-align:left">40.030</td>
</tr>
<tr>
<td style="text-align:left">Average <strong>predicted</strong> volume reserves (thousand barrels)</td>
<td style="text-align:left">92.592</td>
<td style="text-align:left">68.728</td>
<td style="text-align:left">94.965</td>
</tr>
</tbody>
</table>
<hr>
<p>R2 score shows the relative measure of fit, while RMSE is an absolute measure of fit. Lower values of RMSE indicate a better fit.</p>
<p>The model for geo_1 has the best scores for accuracy, R2, and RMSE. With accuracy and R2 being close to 1 and with a very small RMSE it seems like the model can predict pretty well using the dataset provided for geo_1. However, predicted average volume of reserves in ge0_1 is the lowest of the 3 regions being at 68.968 thousands barrels.</p>
<p>The models for geo_0 and geo_2 performed pretty similar for the datasets given for these two regions. The accuracy and R2 score are very small ranging around 0.20 - 0.30 and have RMSE score around 40. In comparison, though these two have similar scores in accuracy, R2 and RMSE, the model for geo_0 did slightly better with a slightly higher accuracy and R2 score and a bit lower RMSE score compared to the model for geo_2.</p>
<p>The model for geo_2 predicted largest average volume of reserves with 94.955 thousands barrels. With geo_0 coming in second with the largest predicted average volume of reserves at 92.708 thousands barrels. geo_1 came in last with the smallest predicted average volume at 68.968 thousand barrels.</p>
<p>Having such a large RMSE score for the models for geo_0 and geo_2 shows that perhaps a linear regression model might not be ideal for these two regions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Profit-calculation">
<a class="anchor" href="#Profit-calculation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Profit calculation<a class="anchor-link" href="#Profit-calculation"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">BUDGET</span> <span class="o">=</span> <span class="mi">100000000</span> <span class="c1"># budget for development of 200 oil wells is 100 USD million</span>
<span class="n">POINT_PER_BUDGET</span> <span class="o">=</span> <span class="mi">200</span> <span class="c1"># number of wells in the budget</span>
<span class="n">PRODUCT_PRICE</span> <span class="o">=</span> <span class="mi">4500</span> <span class="c1"># revenue from one unit of product is 4,500 dollars (volume of reserves is in thousand barrels)</span>

<span class="c1">#Calculation for the volume of reserves sufficient for developing a new well without losses</span>
<span class="n">volume_no_loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">BUDGET</span><span class="o">/</span><span class="n">POINT_PER_BUDGET</span><span class="p">)</span> <span class="o">/</span> <span class="n">PRODUCT_PRICE</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Volume of reserves sufficient for developing a new well without losses:'</span><span class="p">,</span> <span class="n">volume_no_loss</span><span class="p">,</span> <span class="s1">'(thousand barrels)'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">average_volume</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="s1">'product'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Average volume of reserves in each region:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'* geo_0: '</span><span class="p">,</span> <span class="n">average_volume</span><span class="p">(</span><span class="n">geo_0</span><span class="p">),</span> <span class="s1">'(thousand barrels)'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'* geo_1: '</span><span class="p">,</span> <span class="n">average_volume</span><span class="p">(</span><span class="n">geo_1</span><span class="p">),</span> <span class="s1">'(thousand barrels)'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'* geo_2: '</span><span class="p">,</span> <span class="n">average_volume</span><span class="p">(</span><span class="n">geo_2</span><span class="p">),</span> <span class="s1">'(thousand barrels)'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Volume of reserves sufficient for developing a new well without losses: 111.11111111111111 (thousand barrels)

Average volume of reserves in each region:
* geo_0:  92.49999999999976 (thousand barrels)
* geo_1:  68.82500000002561 (thousand barrels)
* geo_2:  95.00000000000041 (thousand barrels)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p>The minimum volume of reserves need to develop a new well without losses is 111.11 (thousand barrels).</p>
<p>Tables showing average volume in each region:</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">geo_0</th>
<th style="text-align:left">geo_1</th>
<th style="text-align:left">geo_2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Average volume of reserves (thousand barrels)</td>
<td style="text-align:left">92.499</td>
<td style="text-align:left">68.825</td>
<td style="text-align:left">95.00</td>
</tr>
<tr>
<td style="text-align:left">Average <strong>predicted</strong> volume reserves (thousand barrels)</td>
<td style="text-align:left">92.592</td>
<td style="text-align:left">68.728</td>
<td style="text-align:left">94.965</td>
</tr>
</tbody>
</table>
<p>Just by looking at the average volume of reserves in reach region (actual and predicted volumes), it doesn't seem that a developing a new well would be profitable. We would have to look at the top producing wells (actual and predicted) in each region to see if the calculation differs.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Profit-from-a-set-of-selected-oil-wells-and-model-predictions">
<a class="anchor" href="#Profit-from-a-set-of-selected-oil-wells-and-model-predictions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Profit from a set of selected oil wells and model predictions<a class="anchor-link" href="#Profit-from-a-set-of-selected-oil-wells-and-model-predictions"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">revenue</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
    <span class="n">y_valid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_valid</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

    <span class="n">predict_sorted</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">selected_wells</span> <span class="o">=</span> <span class="n">y_valid</span><span class="p">[</span><span class="n">predict_sorted</span><span class="o">.</span><span class="n">index</span><span class="p">][:</span><span class="n">count</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">PRODUCT_PRICE</span> <span class="o">*</span> <span class="n">selected_wells</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">profit</span><span class="p">(</span><span class="n">revenue</span><span class="p">):</span>
  
  <span class="n">profit</span> <span class="o">=</span> <span class="n">revenue</span> <span class="o">-</span> <span class="n">BUDGET</span>
  <span class="k">return</span> <span class="n">profit</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rev_geo0</span> <span class="o">=</span> <span class="n">revenue</span><span class="p">(</span><span class="n">geo0_y_valid</span><span class="p">,</span> <span class="n">geo0_predictions</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Predicted profit for region geo_0 with top best 200 wells:'</span><span class="p">,</span> <span class="n">profit</span><span class="p">(</span><span class="n">rev_geo0</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Predicted profit for region geo_0 with top best 200 wells: 33208260.43
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rev_geo1</span> <span class="o">=</span> <span class="n">revenue</span><span class="p">(</span><span class="n">geo1_y_valid</span><span class="p">,</span> <span class="n">geo1_predictions</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Predicted profit for region geo_1 with top best 200 wells:'</span><span class="p">,</span> <span class="n">profit</span><span class="p">(</span><span class="n">rev_geo1</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Predicted profit for region geo_1 with top best 200 wells: 24150866.97
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rev_geo2</span> <span class="o">=</span> <span class="n">revenue</span><span class="p">(</span><span class="n">geo2_y_valid</span><span class="p">,</span> <span class="n">geo2_predictions</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Predicted profit for region geo_2 with top best 200 wells:'</span><span class="p">,</span> <span class="n">profit</span><span class="p">(</span><span class="n">rev_geo2</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Predicted profit for region geo_2 with top best 200 wells: 27103499.64
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p>From the calculations in this section, it's best to develop new wells in region geo_0. The calculation for predicted profit is highest in this region at 33,208,260.43 USD. geo_1 had the lowest predicted profit at 24,150,866.97 USD and geo_2 came out in the middle at 27,103,499.64 USD.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Calculate-risks-and-profit-for-each-region">
<a class="anchor" href="#Calculate-risks-and-profit-for-each-region" aria-hidden="true"><span class="octicon octicon-link"></span></a>Calculate risks and profit for each region<a class="anchor-link" href="#Calculate-risks-and-profit-for-each-region"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">profit_distribution</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">predictions</span><span class="p">):</span>

    <span class="n">y_valid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_valid</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

    <span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
    
    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>

        <span class="n">target_subsample</span> <span class="o">=</span> <span class="n">y_valid</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>
        <span class="n">predict_subsample</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">target_subsample</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> 
        <span class="n">rev</span> <span class="o">=</span> <span class="n">revenue</span><span class="p">(</span><span class="n">target_subsample</span><span class="p">,</span> <span class="n">predict_subsample</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rev</span><span class="p">)</span>

    <span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>

    <span class="n">profit_values</span> <span class="o">=</span> <span class="n">profit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">profit_values</span>

<span class="c1">#Calculation for confidence interval at 95%</span>
<span class="k">def</span> <span class="nf">confidence_interval</span><span class="p">(</span><span class="n">profit_values</span><span class="p">):</span>
  <span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span>
      <span class="mf">0.95</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">profit_values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">profit_values</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">profit_values</span><span class="o">.</span><span class="n">sem</span><span class="p">())</span> 
  
  <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="s2">"95</span><span class="si">% c</span><span class="s2">onfidence interval:"</span><span class="p">,</span> <span class="n">confidence_interval</span><span class="p">)</span>


<span class="c1">#Value at Risk (Risk of Losses) | Confidence Level calculation</span>
<span class="k">def</span> <span class="nf">risk_of_loss</span><span class="p">(</span><span class="n">profit_values</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Value at risk (VaR) is a measure of the risk of loss for investments. </span>
<span class="sd">  It estimates how much a set of investments might lose (with a given probability), </span>
<span class="sd">  given normal market conditions, in a set time period such as a day</span>
<span class="sd">  """</span>
  <span class="n">upper</span> <span class="o">=</span> <span class="n">profit_values</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.975</span><span class="p">)</span>
  <span class="n">lower</span> <span class="o">=</span> <span class="n">profit_values</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.025</span><span class="p">)</span>

  <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span> <span class="n">tabulate</span><span class="p">([[</span><span class="s1">'2.5%'</span><span class="p">,</span> <span class="n">lower</span><span class="p">],</span> <span class="p">[</span><span class="s1">'97.5%'</span><span class="p">,</span> <span class="n">upper</span><span class="p">]],</span> <span class="n">floatfmt</span><span class="o">=</span><span class="s1">'.2f'</span><span class="p">,</span>
                        <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">'Confidence Level'</span><span class="p">,</span> <span class="s1">'Value at Risk'</span><span class="p">]))</span>

<span class="c1">#Sum of loss (negative profit) within our 1000 sample</span>
<span class="k">def</span> <span class="nf">loss</span><span class="p">(</span><span class="n">profit_values</span><span class="p">):</span>
  <span class="n">loss</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">profit_values</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">loss</span>

<span class="c1">#Get number of instances where profit sample is negative</span>
<span class="k">def</span> <span class="nf">count_loss</span><span class="p">(</span><span class="n">profit_values</span><span class="p">):</span>
  <span class="n">num_loss</span> <span class="o">=</span> <span class="n">profit_values</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">num_loss</span>

<span class="c1">#Sum of gain (positive profit) within our 1000 sample</span>
<span class="k">def</span> <span class="nf">gain</span><span class="p">(</span><span class="n">profit_values</span><span class="p">):</span>
  <span class="n">gain</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">profit_values</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">gain</span>

<span class="c1">#Get number of instances where profit sample is positive</span>
<span class="k">def</span> <span class="nf">count_gain</span><span class="p">(</span><span class="n">profit_values</span><span class="p">):</span>
  <span class="n">num_gain</span> <span class="o">=</span> <span class="n">profit_values</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">num_gain</span>


<span class="c1">#Calculation for profit/loss ratio</span>
<span class="k">def</span> <span class="nf">proft_loss_ratio</span><span class="p">(</span><span class="n">profit_values</span><span class="p">):</span>
  <span class="n">total_gain</span> <span class="o">=</span> <span class="n">gain</span><span class="p">(</span><span class="n">profit_values</span><span class="p">)</span>
  <span class="n">total_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">profit_values</span><span class="p">)</span>

  <span class="n">total_num_gain</span> <span class="o">=</span> <span class="n">count_gain</span><span class="p">(</span><span class="n">profit_values</span><span class="p">)</span>
  <span class="n">total_num_loss</span> <span class="o">=</span> <span class="n">count_loss</span><span class="p">(</span><span class="n">profit_values</span><span class="p">)</span>

  <span class="n">ratio</span> <span class="o">=</span> <span class="p">((</span><span class="n">total_gain</span><span class="o">/</span><span class="n">total_num_gain</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">total_loss</span><span class="o">/</span><span class="n">total_num_loss</span><span class="p">))</span>

  <span class="k">return</span> <span class="n">ratio</span>

<span class="c1">#Loss probability calculation</span>
<span class="k">def</span> <span class="nf">loss_prob</span><span class="p">(</span><span class="n">profit_values</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Loss probability is percentage of negative values in profit array</span>
<span class="sd">  """</span>
  <span class="n">total_num_loss</span> <span class="o">=</span> <span class="n">count_loss</span><span class="p">(</span><span class="n">profit_values</span><span class="p">)</span> <span class="c1">#Count of negative values in profit array</span>
  <span class="n">prob</span> <span class="o">=</span> <span class="n">total_num_loss</span> <span class="o">/</span> <span class="mi">1000</span> <span class="c1">#Sample size of 1000 for profit array</span>

  <span class="k">return</span> <span class="n">prob</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo0_profit_values</span> <span class="o">=</span> <span class="n">profit_distribution</span><span class="p">(</span><span class="n">geo0_y_valid</span><span class="p">,</span> <span class="n">geo0_predictions</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Average profit for region geo_0:'</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">geo0_profit_values</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">confidence_interval</span><span class="p">(</span><span class="n">geo0_profit_values</span><span class="p">)</span>

<span class="n">risk_of_loss</span><span class="p">(</span><span class="n">geo0_profit_values</span><span class="p">)</span>

<span class="c1">#Loss probability</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Loss probability for geo_0:'</span><span class="p">,</span> <span class="n">loss_prob</span><span class="p">(</span><span class="n">geo0_profit_values</span><span class="p">),</span> <span class="s1">'or'</span><span class="p">,</span> 
      <span class="s1">'</span><span class="si">{:.2%}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loss_prob</span><span class="p">(</span><span class="n">geo0_profit_values</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Average profit for region geo_0: 3961649.85
95% confidence interval: (3796203.151479729, 4127096.544567701)

 Confidence Level      Value at Risk
------------------  ---------------
2.5%                    -1112155.46
97.5%                    9097669.42

Loss probability for geo_0: 0.069 or 6.90%
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo1_profit_values</span> <span class="o">=</span> <span class="n">profit_distribution</span><span class="p">(</span><span class="n">geo1_y_valid</span><span class="p">,</span> <span class="n">geo1_predictions</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Average profit for region geo_1:'</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">geo1_profit_values</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">confidence_interval</span><span class="p">(</span><span class="n">geo1_profit_values</span><span class="p">)</span>

<span class="n">risk_of_loss</span><span class="p">(</span><span class="n">geo1_profit_values</span><span class="p">)</span>

<span class="c1">#Loss probability</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Loss probability for geo_1:'</span><span class="p">,</span> <span class="n">loss_prob</span><span class="p">(</span><span class="n">geo1_profit_values</span><span class="p">),</span> <span class="s1">'or'</span><span class="p">,</span> 
      <span class="s1">'</span><span class="si">{:.2%}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loss_prob</span><span class="p">(</span><span class="n">geo1_profit_values</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Average profit for region geo_1: 4560451.06
95% confidence interval: (4431472.486639012, 4689429.629094217)

 Confidence Level      Value at Risk
------------------  ---------------
2.5%                      338205.09
97.5%                    8522894.54

Loss probability for geo_1: 0.015 or 1.50%
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo2_profit_values</span> <span class="o">=</span> <span class="n">profit_distribution</span><span class="p">(</span><span class="n">geo2_y_valid</span><span class="p">,</span> <span class="n">geo2_predictions</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Average profit for region geo_2:'</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">geo2_profit_values</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">confidence_interval</span><span class="p">(</span><span class="n">geo2_profit_values</span><span class="p">)</span>

<span class="n">risk_of_loss</span><span class="p">(</span><span class="n">geo2_profit_values</span><span class="p">)</span>

<span class="c1">#Loss probability</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Loss probability for geo_2:'</span><span class="p">,</span> <span class="n">loss_prob</span><span class="p">(</span><span class="n">geo2_profit_values</span><span class="p">),</span> <span class="s1">'or'</span><span class="p">,</span> 
      <span class="s1">'</span><span class="si">{:.2%}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loss_prob</span><span class="p">(</span><span class="n">geo2_profit_values</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Average profit for region geo_2: 4044038.67
95% confidence interval: (3874457.974712804, 4213619.356654332)

 Confidence Level      Value at Risk
------------------  ---------------
2.5%                    -1633504.13
97.5%                    9503595.75

Loss probability for geo_2: 0.076 or 7.60%
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p>Based on the calculations in this section, the best region get develop new oil wells would be region geo_1. Out of the 1000 samples that was obtained in each region, geo_1 had the smallest probablity of loss at 1.50%. The calculated average profit for region geo_1 out of the 1000 sample slice came in at 4,560,451.06 USD which was the highest average profit out of the three regions. The table below summarizes the findings in this secion:</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">geo_0</th>
<th style="text-align:left">geo_1</th>
<th style="text-align:left">geo_2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Average profit (USD)</td>
<td style="text-align:left">3,961,649.85</td>
<td style="text-align:left">4,560,451.06</td>
<td style="text-align:left">4,044,038.67</td>
</tr>
<tr>
<td style="text-align:left">95% confidence interval</td>
<td style="text-align:left">(3796203.15, 4127096.54)</td>
<td style="text-align:left">(4431472.49, 4689429.63)</td>
<td style="text-align:left">(3874457.97, 4213619.36)</td>
</tr>
<tr>
<td style="text-align:left">Risk of loss at 2.5% confidence level</td>
<td style="text-align:left">-1112155.46</td>
<td style="text-align:left">338205.09</td>
<td style="text-align:left">-1633504.13</td>
</tr>
<tr>
<td style="text-align:left">Risk of loss at 97.5% confidence level</td>
<td style="text-align:left">9097669.42</td>
<td style="text-align:left">8522894.54</td>
<td style="text-align:left">9503595.75</td>
</tr>
<tr>
<td style="text-align:left">Loss probability (%)</td>
<td style="text-align:left">6.90%</td>
<td style="text-align:left">1.50%</td>
<td style="text-align:left">7.60%</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Overall-Conclusion">
<a class="anchor" href="#Overall-Conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overall Conclusion<a class="anchor-link" href="#Overall-Conclusion"> </a>
</h1>
<p>In conlusion, with the calculations made for the provided datasets it seems as though region geo_1 is the best region develop new wells. The model for geo_1 had the best scores. The predicted profit for geo_1 came in second out of the three regions which isn't bad. And overall, geo_1 when sampled 1000 wells had the lowest loss probablity and had highest average profit.</p>
<p>The table below summarize the sections we calculated:</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">geo_0</th>
<th style="text-align:left">geo_1</th>
<th style="text-align:left">geo_2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Accuracy Score</td>
<td style="text-align:left">0.2799</td>
<td style="text-align:left">0.9996</td>
<td style="text-align:left">0.2052</td>
</tr>
<tr>
<td style="text-align:left">R2 Score</td>
<td style="text-align:left">0.2799</td>
<td style="text-align:left">0.9996</td>
<td style="text-align:left">0.2052</td>
</tr>
<tr>
<td style="text-align:left">RMSE Score</td>
<td style="text-align:left">37.579</td>
<td style="text-align:left">0.8903</td>
<td style="text-align:left">40.030</td>
</tr>
<tr>
<td style="text-align:left">Average volume of reserves (thousand barrels)</td>
<td style="text-align:left">92.499</td>
<td style="text-align:left">68.825</td>
<td style="text-align:left">95.00</td>
</tr>
<tr>
<td style="text-align:left">Average <strong>predicted</strong> volume reserves (thousand barrels)</td>
<td style="text-align:left">92.592</td>
<td style="text-align:left">68.728</td>
<td style="text-align:left">94.965</td>
</tr>
<tr>
<td style="text-align:left">Predicted profit (USD)</td>
<td style="text-align:left">33,208,260.43</td>
<td style="text-align:left">24,150,866.97</td>
<td style="text-align:left">27,103,499.64</td>
</tr>
<tr>
<td style="text-align:left">Average profit (USD)</td>
<td style="text-align:left">3,961,649.85</td>
<td style="text-align:left">4,560,451.06</td>
<td style="text-align:left">4,044,038.67</td>
</tr>
<tr>
<td style="text-align:left">95% confidence interval</td>
<td style="text-align:left">(3796203.15, 4127096.54)</td>
<td style="text-align:left">(4431472.49, 4689429.63)</td>
<td style="text-align:left">(3874457.97, 4213619.36)</td>
</tr>
<tr>
<td style="text-align:left">Risk of loss at 2.5% confidence level</td>
<td style="text-align:left">-1112155.46</td>
<td style="text-align:left">338205.09</td>
<td style="text-align:left">-1633504.13</td>
</tr>
<tr>
<td style="text-align:left">Risk of loss at 97.5% confidence level</td>
<td style="text-align:left">9097669.42</td>
<td style="text-align:left">8522894.54</td>
<td style="text-align:left">9503595.75</td>
</tr>
<tr>
<td style="text-align:left">Loss probability (%)</td>
<td style="text-align:left">6.90%</td>
<td style="text-align:left">1.50%</td>
<td style="text-align:left">7.60%</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="cmdang-mochi/ds-projects"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/ds-projects/machine%20learning/python/pandas/numpy/scikit-learn/tabulate/scipy/2020/11/22/profit_risks_for_new_oil_wells.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/ds-projects/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/ds-projects/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/ds-projects/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/cmdang-mochi" title="cmdang-mochi"><svg class="svg-icon grey"><use xlink:href="/ds-projects/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/connie-m-dang" title="connie-m-dang"><svg class="svg-icon grey"><use xlink:href="/ds-projects/assets/minima-social-icons.svg#linkedin"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
